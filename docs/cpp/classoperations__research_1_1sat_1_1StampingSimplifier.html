<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Google OR-Tools: operations_research::sat::StampingSimplifier Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="orLogo.png"/></td>
  <td id="projectalign">
   <div id="projectname">Google OR-Tools<span id="projectnumber">&#160;v9.7</span>
   </div>
   <div id="projectbrief">a fast and portable software suite for combinatorial optimization</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classoperations__research_1_1sat_1_1StampingSimplifier.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classoperations__research_1_1sat_1_1StampingSimplifier-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">operations_research::sat::StampingSimplifier Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="sat__inprocessing_8h_source.html">sat_inprocessing.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aab680827f2e3692366e2da6cb939cca2" id="r_aab680827f2e3692366e2da6cb939cca2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoperations__research_1_1sat_1_1StampingSimplifier.html#aab680827f2e3692366e2da6cb939cca2">StampingSimplifier</a> (<a class="el" href="classoperations__research_1_1sat_1_1Model.html">Model</a> *<a class="el" href="gurobi__interface_8cc.html#a0728f23c9a47655d38e0bf1a2f200bcf">model</a>)</td></tr>
<tr class="separator:aab680827f2e3692366e2da6cb939cca2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf4ca83561578670ef702769097d29fd" id="r_abf4ca83561578670ef702769097d29fd"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoperations__research_1_1sat_1_1StampingSimplifier.html#abf4ca83561578670ef702769097d29fd">DoOneRound</a> (bool log_info)</td></tr>
<tr class="separator:abf4ca83561578670ef702769097d29fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e92cf06868589083c5369b049fc5a26" id="r_a2e92cf06868589083c5369b049fc5a26"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoperations__research_1_1sat_1_1StampingSimplifier.html#a2e92cf06868589083c5369b049fc5a26">ComputeStampsForNextRound</a> (bool log_info)</td></tr>
<tr class="separator:a2e92cf06868589083c5369b049fc5a26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4ed798d7a5c1b5957e4f9605963174e" id="r_ab4ed798d7a5c1b5957e4f9605963174e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoperations__research_1_1sat_1_1StampingSimplifier.html#ab4ed798d7a5c1b5957e4f9605963174e">SampleTreeAndFillParent</a> ()</td></tr>
<tr class="memdesc:ab4ed798d7a5c1b5957e4f9605963174e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Visible for testing.  <br /></td></tr>
<tr class="separator:ab4ed798d7a5c1b5957e4f9605963174e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7549385a06aadb13bf4772e9b3172887" id="r_a7549385a06aadb13bf4772e9b3172887"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoperations__research_1_1sat_1_1StampingSimplifier.html#a7549385a06aadb13bf4772e9b3172887">ComputeStamps</a> ()</td></tr>
<tr class="separator:a7549385a06aadb13bf4772e9b3172887"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a769f8039c1ae2eb9424ddebfb4523ab4" id="r_a769f8039c1ae2eb9424ddebfb4523ab4"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoperations__research_1_1sat_1_1StampingSimplifier.html#a769f8039c1ae2eb9424ddebfb4523ab4">ImplicationIsInTree</a> (<a class="el" href="classoperations__research_1_1sat_1_1Literal.html">Literal</a> <a class="el" href="constraint__solver_2table_8cc.html#acb18315d548212835cd8ed4287e6c0b6">a</a>, <a class="el" href="classoperations__research_1_1sat_1_1Literal.html">Literal</a> <a class="el" href="namespaceoperations__research_1_1sat.html#aea68c208c5e7f0abb9afc90d9188d3d4">b</a>) const</td></tr>
<tr class="separator:a769f8039c1ae2eb9424ddebfb4523ab4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adeaa7bc64c667a667195ba5f6161f8c1" id="r_adeaa7bc64c667a667195ba5f6161f8c1"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoperations__research_1_1sat_1_1StampingSimplifier.html#adeaa7bc64c667a667195ba5f6161f8c1">ProcessClauses</a> ()</td></tr>
<tr class="separator:adeaa7bc64c667a667195ba5f6161f8c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implements "stamping" as described in "Efficient CNF Simplification based on
Binary Implication Graphs", Marijn Heule, Matti Jarvisalo and Armin Biere.</p>
<p>This sample the implications graph with a spanning tree, and then simplify all clauses (subsumption / strengthening) using the implications encoded in this tree. So this allows to consider chain of implications instead of just direct ones, but depending on the problem, only a small fraction of the implication graph will be captured by the tree.</p>
<dl class="section note"><dt>Note</dt><dd>we randomize the spanning tree at each call. This can benefit by having the implication graph be transitively reduced before. </dd></dl>

<p class="definition">Definition at line <a class="el" href="sat__inprocessing_8h_source.html#l00179">179</a> of file <a class="el" href="sat__inprocessing_8h_source.html">sat_inprocessing.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aab680827f2e3692366e2da6cb939cca2" name="aab680827f2e3692366e2da6cb939cca2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab680827f2e3692366e2da6cb939cca2">&#9670;&#160;</a></span>StampingSimplifier()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">operations_research::sat::StampingSimplifier::StampingSimplifier </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classoperations__research_1_1sat_1_1Model.html">Model</a> *&#160;</td>
          <td class="paramname"><em>model</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sat__inprocessing_8h_source.html#l00181">181</a> of file <a class="el" href="sat__inprocessing_8h_source.html">sat_inprocessing.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a7549385a06aadb13bf4772e9b3172887" name="a7549385a06aadb13bf4772e9b3172887"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7549385a06aadb13bf4772e9b3172887">&#9670;&#160;</a></span>ComputeStamps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool operations_research::sat::StampingSimplifier::ComputeStamps </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Using a DFS visiting order, we can answer reachability query in O(1) on a tree, this is well known. <a class="el" href="classoperations__research_1_1sat_1_1StampingSimplifier.html#a7549385a06aadb13bf4772e9b3172887">ComputeStamps()</a> also detect failed literal in the tree and fix them. It can return false on UNSAT. </p>
<p>Compute sizes.</p>
<p>Compute starts in the children_ vector for each node.</p>
<p>Fill children. This messes up starts_.</p>
<p>Reset starts to correct value.</p>
<p>Perform a DFS from each root to compute the stamps.</p>
<p>Failed literal detection. If the negation of top is in the same tree, we can fix the LCA of top and its negation to false.</p>
<p>Find the LCA.</p>

<p class="definition">Definition at line <a class="el" href="sat__inprocessing_8cc_source.html#l00690">690</a> of file <a class="el" href="sat__inprocessing_8cc_source.html">sat_inprocessing.cc</a>.</p>

</div>
</div>
<a id="a2e92cf06868589083c5369b049fc5a26" name="a2e92cf06868589083c5369b049fc5a26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e92cf06868589083c5369b049fc5a26">&#9670;&#160;</a></span>ComputeStampsForNextRound()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool operations_research::sat::StampingSimplifier::ComputeStampsForNextRound </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>log_info</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>When we compute stamps, we might detect fixed variable (via failed literal probing in the implication graph). So it might make sense to do that until we have dealt with all fixed literals before calling <a class="el" href="classoperations__research_1_1sat_1_1StampingSimplifier.html#abf4ca83561578670ef702769097d29fd">DoOneRound()</a>. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo002044">Todo:</a></b></dt><dd>(user): compute some dtime, it is always zero currently. </dd></dl>

<p class="definition">Definition at line <a class="el" href="sat__inprocessing_8cc_source.html#l00631">631</a> of file <a class="el" href="sat__inprocessing_8cc_source.html">sat_inprocessing.cc</a>.</p>

</div>
</div>
<a id="abf4ca83561578670ef702769097d29fd" name="abf4ca83561578670ef702769097d29fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf4ca83561578670ef702769097d29fd">&#9670;&#160;</a></span>DoOneRound()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool operations_research::sat::StampingSimplifier::DoOneRound </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>log_info</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This is "fast" (linear scan + sort of all clauses) so we always complete the full round.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo002080">Todo:</a></b></dt><dd>(user): To save one scan over all the clauses, we could do the fixed and equivalence variable cleaning here too. </dd></dl>
<p>We need a DAG so that we don't have cycle while we sample the tree. </p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo002043">Todo:</a></b></dt><dd>(user): We could probably deal with it if needed so that we don't need to do equivalence detection each time we want to run this. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>num_removed_literals_ do not count the literals of the subsumed clauses.</dd></dl>

<p class="definition">Definition at line <a class="el" href="sat__inprocessing_8cc_source.html#l00595">595</a> of file <a class="el" href="sat__inprocessing_8cc_source.html">sat_inprocessing.cc</a>.</p>

</div>
</div>
<a id="a769f8039c1ae2eb9424ddebfb4523ab4" name="a769f8039c1ae2eb9424ddebfb4523ab4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a769f8039c1ae2eb9424ddebfb4523ab4">&#9670;&#160;</a></span>ImplicationIsInTree()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool operations_research::sat::StampingSimplifier::ImplicationIsInTree </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classoperations__research_1_1sat_1_1Literal.html">Literal</a>&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classoperations__research_1_1sat_1_1Literal.html">Literal</a>&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sat__inprocessing_8h_source.html#l00207">207</a> of file <a class="el" href="sat__inprocessing_8h_source.html">sat_inprocessing.h</a>.</p>

</div>
</div>
<a id="adeaa7bc64c667a667195ba5f6161f8c1" name="adeaa7bc64c667a667195ba5f6161f8c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adeaa7bc64c667a667195ba5f6161f8c1">&#9670;&#160;</a></span>ProcessClauses()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool operations_research::sat::StampingSimplifier::ProcessClauses </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section note"><dt>Note</dt><dd>we might fix literal as we perform the loop here, so we do need to deal with them.</dd></dl>
<p>For a and b in the clause, if not(a) =&gt; b is present, then the clause is subsumed. If a =&gt; b, then a can be removed, and if not(a) =&gt; not(b) then b can be removed. Nothing can be done if a =&gt; not(b).</p>
<p>The sort should be dominant.</p>
<p>We found an implication: top_entry =&gt; this entry.</p>
<p>Failed literal?</p>
<p>not(span[i]) =&gt; span[i] so span[i] true. And the clause is satisfied (so we count as as subsumed).</p>
<p>span[i] =&gt; not(span[i]) so span[i] false.</p>
<p>not(a) =&gt; b : subsumption. a =&gt; not(b), we cannot deduce anything, but it might make sense to see if not(b) implies anything instead of just keeping top_entry. See </p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo002048">Todo:</a></b></dt><dd>below. </dd></dl>
<p>not(a) =&gt; not(b), we can remove b.</p>
<p>a =&gt; b, we can remove a.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo002049">Todo:</a></b></dt><dd>(user): Note that it is okay to still use top_entry, but we might miss the removal of b if b =&gt; c. Also the paper do things differently. Make sure we don't miss any simplification opportunites by not changing top_entry. Same in the other branches. </dd></dl>
<p>Strengthen the clause.</p>

<p class="definition">Definition at line <a class="el" href="sat__inprocessing_8cc_source.html#l00775">775</a> of file <a class="el" href="sat__inprocessing_8cc_source.html">sat_inprocessing.cc</a>.</p>

</div>
</div>
<a id="ab4ed798d7a5c1b5957e4f9605963174e" name="ab4ed798d7a5c1b5957e4f9605963174e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4ed798d7a5c1b5957e4f9605963174e">&#9670;&#160;</a></span>SampleTreeAndFillParent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void operations_research::sat::StampingSimplifier::SampleTreeAndFillParent </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Visible for testing. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo002045">Todo:</a></b></dt><dd>(user): Better algo to not select redundant parent.</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo002046">Todo:</a></b></dt><dd>(user): if parents_[x] = y, try not to have parents_[not(y)] = not(x) because this is not as useful for the simplification power.</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo002047">Todo:</a></b></dt><dd>(user): More generally, we could sample a parent while probing so that we consider all hyper binary implications (in the case we don't add them to the implication graph already). </dd></dl>
<p>We found an interesting parent.</p>

<p class="definition">Definition at line <a class="el" href="sat__inprocessing_8cc_source.html#l00655">655</a> of file <a class="el" href="sat__inprocessing_8cc_source.html">sat_inprocessing.cc</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>ortools/sat/<a class="el" href="sat__inprocessing_8h_source.html">sat_inprocessing.h</a></li>
<li>ortools/sat/<a class="el" href="sat__inprocessing_8cc_source.html">sat_inprocessing.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceoperations__research.html">operations_research</a></li><li class="navelem"><a class="el" href="namespaceoperations__research_1_1sat.html">sat</a></li><li class="navelem"><a class="el" href="classoperations__research_1_1sat_1_1StampingSimplifier.html">StampingSimplifier</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
