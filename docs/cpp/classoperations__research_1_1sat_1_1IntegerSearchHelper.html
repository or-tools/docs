<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Google OR-Tools: operations_research::sat::IntegerSearchHelper Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="orLogo.png"/></td>
  <td id="projectalign">
   <div id="projectname">Google OR-Tools<span id="projectnumber">&#160;v9.8</span>
   </div>
   <div id="projectbrief">a fast and portable software suite for combinatorial optimization</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classoperations__research_1_1sat_1_1IntegerSearchHelper.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classoperations__research_1_1sat_1_1IntegerSearchHelper-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">operations_research::sat::IntegerSearchHelper Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>An helper class to share the code used by the different kind of search.  
 <a href="classoperations__research_1_1sat_1_1IntegerSearchHelper.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="integer__search_8h_source.html">integer_search.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a1edce26656a3005817e7729dc560dfc7" id="r_a1edce26656a3005817e7729dc560dfc7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoperations__research_1_1sat_1_1IntegerSearchHelper.html#a1edce26656a3005817e7729dc560dfc7">IntegerSearchHelper</a> (<a class="el" href="classoperations__research_1_1sat_1_1Model.html">Model</a> *<a class="el" href="gurobi__interface_8cc.html#a0728f23c9a47655d38e0bf1a2f200bcf">model</a>)</td></tr>
<tr class="separator:a1edce26656a3005817e7729dc560dfc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0ee78224d85d7bacc01e604d5cd2b5d" id="r_ae0ee78224d85d7bacc01e604d5cd2b5d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoperations__research_1_1sat_1_1IntegerSearchHelper.html#ae0ee78224d85d7bacc01e604d5cd2b5d">BeforeTakingDecision</a> ()</td></tr>
<tr class="separator:ae0ee78224d85d7bacc01e604d5cd2b5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2d4796c1f43982c5c9f31174be82908" id="r_ac2d4796c1f43982c5c9f31174be82908"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoperations__research_1_1sat_1_1IntegerSearchHelper.html#ac2d4796c1f43982c5c9f31174be82908">GetDecision</a> (const std::function&lt; <a class="el" href="structoperations__research_1_1sat_1_1BooleanOrIntegerLiteral.html">BooleanOrIntegerLiteral</a>()&gt; &amp;f, LiteralIndex *decision)</td></tr>
<tr class="separator:ac2d4796c1f43982c5c9f31174be82908"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae585ee5232c5a6f6f28eb072a05d2e4c" id="r_ae585ee5232c5a6f6f28eb072a05d2e4c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoperations__research_1_1sat_1_1IntegerSearchHelper.html#ae585ee5232c5a6f6f28eb072a05d2e4c">NotifyThatConflictWasFoundDuringGetDecision</a> ()</td></tr>
<tr class="separator:ae585ee5232c5a6f6f28eb072a05d2e4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e2faa726399df6f91e4dc89d9ed5117" id="r_a2e2faa726399df6f91e4dc89d9ed5117"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoperations__research_1_1sat_1_1IntegerSearchHelper.html#a2e2faa726399df6f91e4dc89d9ed5117">TakeDecision</a> (<a class="el" href="classoperations__research_1_1sat_1_1Literal.html">Literal</a> decision)</td></tr>
<tr class="separator:a2e2faa726399df6f91e4dc89d9ed5117"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee604e664f5122db61cd4c73f437be2a" id="r_aee604e664f5122db61cd4c73f437be2a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classoperations__research_1_1sat_1_1SatSolver.html#a8022922b9cf102d6697157b3f2ccc352">SatSolver::Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoperations__research_1_1sat_1_1IntegerSearchHelper.html#aee604e664f5122db61cd4c73f437be2a">SolveIntegerProblem</a> ()</td></tr>
<tr class="separator:aee604e664f5122db61cd4c73f437be2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>An helper class to share the code used by the different kind of search. </p>

<p class="definition">Definition at line <a class="el" href="integer__search_8h_source.html#l00264">264</a> of file <a class="el" href="integer__search_8h_source.html">integer_search.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a1edce26656a3005817e7729dc560dfc7" name="a1edce26656a3005817e7729dc560dfc7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1edce26656a3005817e7729dc560dfc7">&#9670;&#160;</a></span>IntegerSearchHelper()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">operations_research::sat::IntegerSearchHelper::IntegerSearchHelper </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classoperations__research_1_1sat_1_1Model.html">Model</a> *&#160;</td>
          <td class="paramname"><em>model</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This is needed for recording the pseudo-costs.</p>

<p class="definition">Definition at line <a class="el" href="integer__search_8cc_source.html#l01241">1241</a> of file <a class="el" href="integer__search_8cc_source.html">integer_search.cc</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ae0ee78224d85d7bacc01e604d5cd2b5d" name="ae0ee78224d85d7bacc01e604d5cd2b5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0ee78224d85d7bacc01e604d5cd2b5d">&#9670;&#160;</a></span>BeforeTakingDecision()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool operations_research::sat::IntegerSearchHelper::BeforeTakingDecision </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Executes some code before a new decision. Returns false if model is UNSAT. </p>
<p>If we pushed root level deductions, we restart to incorporate them. </p><dl class="section note"><dt>Note</dt><dd>in the present of assumptions, it is important to return to the level zero first ! otherwise, the new deductions will not be incorporated and the solver will loop forever.</dd></dl>

<p class="definition">Definition at line <a class="el" href="integer__search_8cc_source.html#l01257">1257</a> of file <a class="el" href="integer__search_8cc_source.html">integer_search.cc</a>.</p>

</div>
</div>
<a id="ac2d4796c1f43982c5c9f31174be82908" name="ac2d4796c1f43982c5c9f31174be82908"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2d4796c1f43982c5c9f31174be82908">&#9670;&#160;</a></span>GetDecision()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool operations_research::sat::IntegerSearchHelper::GetDecision </td>
          <td>(</td>
          <td class="paramtype">const std::function&lt; <a class="el" href="structoperations__research_1_1sat_1_1BooleanOrIntegerLiteral.html">BooleanOrIntegerLiteral</a>()&gt; &amp;&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LiteralIndex *&#160;</td>
          <td class="paramname"><em>decision</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calls the decision heuristics and extract a non-fixed literal. </p><dl class="section note"><dt>Note</dt><dd>we do not want to copy the function here.</dd></dl>
<p>Returns false if a conflict was found while trying to take a decision. </p>
<p>Convert integer decision to literal one if needed.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo001691">Todo:</a></b></dt><dd>(user): Ideally it would be cool to delay the creation even more until we have a conflict with these decisions, but it is currently hard to do so. </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo001692">Todo:</a></b></dt><dd>(user): It would be nicer if this can never happen. For now, it does because of the Propagate() not reaching the fixed point as mentioned in a</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo001693">Todo:</a></b></dt><dd></dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo001694">Todo:</a></b></dt><dd>above. As a work-around, we display a message but do not crash and recall the decision heuristic. </dd></dl>

<p class="definition">Definition at line <a class="el" href="integer__search_8cc_source.html#l01287">1287</a> of file <a class="el" href="integer__search_8cc_source.html">integer_search.cc</a>.</p>

</div>
</div>
<a id="ae585ee5232c5a6f6f28eb072a05d2e4c" name="ae585ee5232c5a6f6f28eb072a05d2e4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae585ee5232c5a6f6f28eb072a05d2e4c">&#9670;&#160;</a></span>NotifyThatConflictWasFoundDuringGetDecision()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void operations_research::sat::IntegerSearchHelper::NotifyThatConflictWasFoundDuringGetDecision </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Functions passed to <a class="el" href="classoperations__research_1_1sat_1_1IntegerSearchHelper.html#ac2d4796c1f43982c5c9f31174be82908">GetDecision()</a> might call this to notify a conflict was detected. </p>

<p class="definition">Definition at line <a class="el" href="integer__search_8h_source.html#l00281">281</a> of file <a class="el" href="integer__search_8h_source.html">integer_search.h</a>.</p>

</div>
</div>
<a id="aee604e664f5122db61cd4c73f437be2a" name="aee604e664f5122db61cd4c73f437be2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee604e664f5122db61cd4c73f437be2a">&#9670;&#160;</a></span>SolveIntegerProblem()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classoperations__research_1_1sat_1_1SatSolver.html#a8022922b9cf102d6697157b3f2ccc352">SatSolver::Status</a> operations_research::sat::IntegerSearchHelper::SolveIntegerProblem </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Tries to find a feasible solution to the current model.</p>
<p>This function continues from the current state of the solver and loop until all variables are instantiated (i.e. the next decision is kNoLiteralIndex) or a search limit is reached. It uses the heuristic from the <a class="el" href="structoperations__research_1_1sat_1_1SearchHeuristics.html">SearchHeuristics</a> class in the model to decide when to restart and what next decision to take.</p>
<p>Each time a restart happen, this increment the policy index modulo the number of heuristics to act as a portfolio search. </p>
<dl class="section note"><dt>Note</dt><dd>it is important to do the level-zero propagation if it wasn't already done because EnqueueDecisionAndBackjumpOnConflict() assumes that the solver is in a "propagated" state.</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo001696">Todo:</a></b></dt><dd>(user): We have the issue that at level zero. calling the propagation loop more than once can propagate more! This is because we call the LP again and again on each level zero propagation. This is causing some CHECKs() to fail in multithread (rarely) because when we associate new literals to integer ones, Propagate() is indirectly called. Not sure yet how to fix. </dd></dl>
<p>Main search loop.</p>
<p>If needed, restart and switch decision_policy.</p>
<dl class="section note"><dt>Note</dt><dd>to properly count the num_times, we do not want to move this function, but actually call that copy.</dd></dl>
<p>Probing?</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo001697">Todo:</a></b></dt><dd>(user): Be smarter about what variables we probe, we can also do more than one. </dd></dl>
<p>We need to check after the probing that the literal is not fixed, otherwise we just go to the next decision.</p>
<p>No decision means that we reached a leave of the search tree and that we have a feasible solution.</p>
<p>Tricky: If the time limit is reached during the final propagation when all variables are fixed, there is no guarantee that the propagation responsible for testing the validity of the solution was run to completion. So we cannot report a feasible solution.</p>
<p>Save the current polarity of all Booleans in the solution. It will be followed for the next SAT decisions. This is known to be a good policy for optimization problem. Note that for decision problem we don't care since we are just done as soon as a solution is found.</p>
<p>This idea is kind of "well known", see for instance the "LinSBPS" submission to the maxSAT 2018 competition by Emir Demirovic and Peter Stuckey where they show it is a good idea and provide more references.</p>
<p>In multi-thread, we really only want to save the LP relaxation for thread with high linearization level to avoid to pollute the repository with sub-par lp solutions.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo001698">Todo:</a></b></dt><dd>(user): Experiment more around dynamically changing the threshold for storing LP solutions in the pool. Alternatively expose this as parameter so this can be tuned later.</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo001699">Todo:</a></b></dt><dd>(user): Avoid adding the same solution many time if the LP didn't change. Avoid adding solution that are too deep in the tree (most variable fixed). Also use a callback rather than having this here, we don't want this file to depend on <a class="el" href="cp__model_8proto.html">cp_model.proto</a>. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>We can actually record LP solutions more frequently. However this process is time consuming and workers waste a lot of time doing this. To avoid this we don't record solutions after each decision.</dd></dl>

<p class="definition">Definition at line <a class="el" href="integer__search_8cc_source.html#l01384">1384</a> of file <a class="el" href="integer__search_8cc_source.html">integer_search.cc</a>.</p>

</div>
</div>
<a id="a2e2faa726399df6f91e4dc89d9ed5117" name="a2e2faa726399df6f91e4dc89d9ed5117"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e2faa726399df6f91e4dc89d9ed5117">&#9670;&#160;</a></span>TakeDecision()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool operations_research::sat::IntegerSearchHelper::TakeDecision </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classoperations__research_1_1sat_1_1Literal.html">Literal</a>&#160;</td>
          <td class="paramname"><em>decision</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Tries to take the current decision, this might backjump. Returns false if the model is UNSAT. </p>
<p>Record the changelist and objective bounds for updating pseudo costs.</p>
<dl class="section note"><dt>Note</dt><dd>kUnsatTrailIndex might also mean ASSUMPTIONS_UNSAT.</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo001695">Todo:</a></b></dt><dd>(user): on some problems, this function can be quite long. Expand so that we can check the time limit at each step? </dd></dl>
<p>Update the implied bounds each time we enqueue a literal at level zero. This is "almost free", so we might as well do it.</p>
<p>Update the pseudo costs.</p>

<p class="definition">Definition at line <a class="el" href="integer__search_8cc_source.html#l01344">1344</a> of file <a class="el" href="integer__search_8cc_source.html">integer_search.cc</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>ortools/sat/<a class="el" href="integer__search_8h_source.html">integer_search.h</a></li>
<li>ortools/sat/<a class="el" href="integer__search_8cc_source.html">integer_search.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceoperations__research.html">operations_research</a></li><li class="navelem"><a class="el" href="namespaceoperations__research_1_1sat.html">sat</a></li><li class="navelem"><a class="el" href="classoperations__research_1_1sat_1_1IntegerSearchHelper.html">IntegerSearchHelper</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
