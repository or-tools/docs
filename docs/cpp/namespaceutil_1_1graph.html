<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Google OR-Tools: util::graph Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="orLogo.png"/></td>
  <td id="projectalign">
   <div id="projectname">Google OR-Tools<span id="projectnumber">&#160;v9.8</span>
   </div>
   <div id="projectbrief">a fast and portable software suite for combinatorial optimization</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('namespaceutil_1_1graph.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">util::graph Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0d7ab592842225bf80afd735048a0e0e" id="r_a0d7ab592842225bf80afd735048a0e0e"><td class="memTemplParams" colspan="2">template&lt;class AdjacencyLists &gt; </td></tr>
<tr class="memitem:a0d7ab592842225bf80afd735048a0e0e"><td class="memTemplItemLeft" align="right" valign="top">absl::StatusOr&lt; std::vector&lt; int &gt; &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespaceutil_1_1graph.html#a0d7ab592842225bf80afd735048a0e0e">FastTopologicalSort</a> (const AdjacencyLists &amp;adj)</td></tr>
<tr class="separator:a0d7ab592842225bf80afd735048a0e0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a440afdf238e5a752bbe4e1bcc8878fe7" id="r_a440afdf238e5a752bbe4e1bcc8878fe7"><td class="memTemplParams" colspan="2">template&lt;class AdjacencyLists &gt; </td></tr>
<tr class="memitem:a440afdf238e5a752bbe4e1bcc8878fe7"><td class="memTemplItemLeft" align="right" valign="top">absl::StatusOr&lt; std::vector&lt; int &gt; &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespaceutil_1_1graph.html#a440afdf238e5a752bbe4e1bcc8878fe7">FindCycleInGraph</a> (const AdjacencyLists &amp;adj)</td></tr>
<tr class="separator:a440afdf238e5a752bbe4e1bcc8878fe7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a0d7ab592842225bf80afd735048a0e0e" name="a0d7ab592842225bf80afd735048a0e0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d7ab592842225bf80afd735048a0e0e">&#9670;&#160;</a></span>FastTopologicalSort()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class AdjacencyLists &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">absl::StatusOr&lt; std::vector&lt; int &gt; &gt; util::graph::FastTopologicalSort </td>
          <td>(</td>
          <td class="paramtype">const AdjacencyLists &amp;&#160;</td>
          <td class="paramname"><em>adj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This is the recommended API when performance matters. It's also very simple. AdjacencyList is any type that lets you iterate over the neighbors of node with the [] operator, for example vector&lt;vector&lt;int&gt;&gt; or <a class="el" href="namespaceutil.html#ae76339cb2dcd3bc05ad762146f91fdda" title="Defining the simplest Graph interface as Graph for convenience.">util::Graph</a>.</p>
<p>If you don't already have an adjacency list representation, build one using StaticGraph&lt;&gt; in ./graph.h: <a class="el" href="namespaceutil_1_1graph.html#a0d7ab592842225bf80afd735048a0e0e">FastTopologicalSort()</a> can take any such graph as input.</p>
<p>ERRORS: returns InvalidArgumentError if the input is broken (negative or out-of-bounds integers) or if the graph is cyclic. In the latter case, the error message will contain "cycle". Note that if cycles may occur in your input, you can probably assume that your input isn't broken, and thus rely on failures to detect that the graph is cyclic.</p>
<p>TIE BREAKING: the returned topological order is deterministic and fixed, and corresponds to iterating on nodes in a LIFO (Breadth-first) order.</p>
<p>Benchmark: gpaste/6147236302946304, 4-10x faster than util_graph::TopoSort().</p>
<p>EXAMPLES: std::vector&lt;std::vector&lt;int&gt;&gt; adj = {{..}, {..}, ..}; <a class="el" href="base_2status__macros_8h.html#a600de4b8f65fe0a4b1898041634f9011">ASSIGN_OR_RETURN(std::vector&lt;int&gt; topo_order, FastTopologicalSort(adj))</a>;</p>
<p>or std::vector&lt;pair&lt;int, int&gt;&gt; arcs = {{.., ..}, ..., }; ASSIGN_OR_RETURN( std::vector&lt;int&gt; topo_order, FastTopologicalSort(util::StaticGraph&lt;&gt;::FromArcs(num_nodes, arcs))); </p>
<p>We cast to unsigned int to test "head &lt; 0 || head ≥ num_nodes" with a single test. Microbenchmarks showed a ~1% overall performance gain.</p>
<p>NOTE(user): We could detect self-arcs here (head == from) and exit early, but microbenchmarks show a 2 to 4% slow-down if we do it, so we simply rely on self-arcs being detected as cycles in the topo sort.</p>
<p>We cast to unsigned int to test "head &lt; 0 || head ≥ num_nodes" with a single test. Microbenchmarks showed a ~1% overall performance gain.</p>
<p>NOTE(user): We could detect self-arcs here (head == from) and exit early, but microbenchmarks show a 2 to 4% slow-down if we do it, so we simply rely on self-arcs being detected as cycles in the topo sort.</p>

<p class="definition">Definition at line <a class="el" href="topologicalsorter_8h_source.html#l00617">617</a> of file <a class="el" href="topologicalsorter_8h_source.html">topologicalsorter.h</a>.</p>

</div>
</div>
<a id="a440afdf238e5a752bbe4e1bcc8878fe7" name="a440afdf238e5a752bbe4e1bcc8878fe7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a440afdf238e5a752bbe4e1bcc8878fe7">&#9670;&#160;</a></span>FindCycleInGraph()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class AdjacencyLists &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">absl::StatusOr&lt; std::vector&lt; int &gt; &gt; util::graph::FindCycleInGraph </td>
          <td>(</td>
          <td class="paramtype">const AdjacencyLists &amp;&#160;</td>
          <td class="paramname"><em>adj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Finds a cycle in the directed graph given as argument: nodes are dense integers in 0..num_nodes-1, and (directed) arcs are pairs of nodes {from, to}. The returned cycle is a list of nodes that form a cycle, eg. {1, 4, 3} if the cycle 1-&gt;4-&gt;3-&gt;1 exists. If the graph is acyclic, returns an empty vector. </p>
<p>To find a cycle, we start a DFS from each yet-unvisited node and try to find a cycle, if we don't find it then we know for sure that no cycle is reachable from any of the explored nodes (so, we don't explore them in later DFSs).</p>
<p>The DFS stack will contain a chain of nodes, from the root of the DFS to the current leaf.</p>
<p>Points at the first child node that we did <em>not</em> yet look at.</p>
<p>Start the DFS.</p>
<p>Look at the current child, and increase the current state's adj_list_index. </p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000698">Todo:</a></b></dt><dd>(user): Caching adj[cur_state-&gt;node] in a local stack to improve locality and so that the [] operator is called exactly once per node. </dd></dl>
<p>We detected a cycle! It corresponds to the tail end of dfs_stack, in reverse order, until we find "child".</p>
<p>Push the child onto the stack.</p>
<p>Verify that its adjacency list seems valid.</p>
<p>If we're here, then all the DFS stopped, and there is no cycle.</p>
<p>To find a cycle, we start a DFS from each yet-unvisited node and try to find a cycle, if we don't find it then we know for sure that no cycle is reachable from any of the explored nodes (so, we don't explore them in later DFSs).</p>
<p>The DFS stack will contain a chain of nodes, from the root of the DFS to the current leaf.</p>
<p>Points at the first child node that we did <em>not</em> yet look at.</p>
<p>Start the DFS.</p>
<p>Look at the current child, and increase the current state's adj_list_index. </p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000698">Todo:</a></b></dt><dd>(user): Caching adj[cur_state-&gt;node] in a local stack to improve locality and so that the [] operator is called exactly once per node. </dd></dl>
<p>We detected a cycle! It corresponds to the tail end of dfs_stack, in reverse order, until we find "child".</p>
<p>Push the child onto the stack.</p>
<p>Verify that its adjacency list seems valid.</p>
<p>If we're here, then all the DFS stopped, and there is no cycle.</p>

<p class="definition">Definition at line <a class="el" href="topologicalsorter_8h_source.html#l00658">658</a> of file <a class="el" href="topologicalsorter_8h_source.html">topologicalsorter.h</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceutil.html">util</a></li><li class="navelem"><a class="el" href="namespaceutil_1_1graph.html">graph</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
