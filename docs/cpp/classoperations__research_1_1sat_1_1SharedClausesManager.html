<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Google OR-Tools: operations_research::sat::SharedClausesManager Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="orLogo.png"/></td>
  <td id="projectalign">
   <div id="projectname">Google OR-Tools<span id="projectnumber">&#160;v9.11</span>
   </div>
   <div id="projectbrief">a fast and portable software suite for combinatorial optimization</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('classoperations__research_1_1sat_1_1SharedClausesManager.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classoperations__research_1_1sat_1_1SharedClausesManager-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">operations_research::sat::SharedClausesManager Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="synchronization_8h_source.html">synchronization.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:adebe4ba0a3e1963a1d284180ad8521ac" id="r_adebe4ba0a3e1963a1d284180ad8521ac"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adebe4ba0a3e1963a1d284180ad8521ac">SharedClausesManager</a> (bool always_synchronize, absl::Duration share_frequency)</td></tr>
<tr class="separator:adebe4ba0a3e1963a1d284180ad8521ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a390489b2496af213519d6fe6445bbeb3" id="r_a390489b2496af213519d6fe6445bbeb3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a390489b2496af213519d6fe6445bbeb3">AddBinaryClause</a> (int id, int lit1, int lit2)</td></tr>
<tr class="separator:a390489b2496af213519d6fe6445bbeb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b79336ed6c8b47cb8f4cfea2c985c5d" id="r_a7b79336ed6c8b47cb8f4cfea2c985c5d"><td class="memItemLeft" align="right" valign="top">std::vector&lt; absl::Span&lt; const int &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a7b79336ed6c8b47cb8f4cfea2c985c5d">GetUnseenClauses</a> (int id)</td></tr>
<tr class="separator:a7b79336ed6c8b47cb8f4cfea2c985c5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75aa139a83b7c7db55dc8151d31b09f1" id="r_a75aa139a83b7c7db55dc8151d31b09f1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a75aa139a83b7c7db55dc8151d31b09f1">GetUnseenBinaryClauses</a> (int id, std::vector&lt; std::pair&lt; int, int &gt; &gt; *new_clauses)</td></tr>
<tr class="separator:a75aa139a83b7c7db55dc8151d31b09f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a089a13e3aa37086807dde0429507020c" id="r_a089a13e3aa37086807dde0429507020c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a089a13e3aa37086807dde0429507020c">RegisterNewId</a> ()</td></tr>
<tr class="memdesc:a089a13e3aa37086807dde0429507020c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ids are used to identify which worker is exporting/importing clauses.  <br /></td></tr>
<tr class="separator:a089a13e3aa37086807dde0429507020c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56bea8ae926c5bebbd51b97185d4178f" id="r_a56bea8ae926c5bebbd51b97185d4178f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a56bea8ae926c5bebbd51b97185d4178f">SetWorkerNameForId</a> (int id, const std::string &amp;worker_name)</td></tr>
<tr class="separator:a56bea8ae926c5bebbd51b97185d4178f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6732839f19e65abca96f400331b89bee" id="r_a6732839f19e65abca96f400331b89bee"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classoperations__research_1_1sat_1_1UniqueClauseStream.html">UniqueClauseStream</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6732839f19e65abca96f400331b89bee">GetClauseStream</a> (int id)</td></tr>
<tr class="separator:a6732839f19e65abca96f400331b89bee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4046c7b70d9cb4de9e59f29ab24fbf1d" id="r_a4046c7b70d9cb4de9e59f29ab24fbf1d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4046c7b70d9cb4de9e59f29ab24fbf1d">LogStatistics</a> (<a class="el" href="classoperations__research_1_1SolverLogger.html">SolverLogger</a> *logger)</td></tr>
<tr class="memdesc:a4046c7b70d9cb4de9e59f29ab24fbf1d"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classoperations__research_1_1Search.html" title="---------------— Search class --------------—">Search</a> statistics.  <br /></td></tr>
<tr class="separator:a4046c7b70d9cb4de9e59f29ab24fbf1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ebbcf2be803ef7f2cbad87a044dc4ec" id="r_a3ebbcf2be803ef7f2cbad87a044dc4ec"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3ebbcf2be803ef7f2cbad87a044dc4ec">Synchronize</a> ()</td></tr>
<tr class="separator:a3ebbcf2be803ef7f2cbad87a044dc4ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class holds clauses found and shared by workers. It is exact for binary clauses, but approximate for longer ones.</p>
<p>It is thread-safe.</p>
<dl class="section note"><dt>Note</dt><dd>this uses literal as encoded in a <a class="el" href="cp__model_8proto.html">cp_model.proto</a>. Thus, the literals can be negative numbers. </dd></dl>

<p class="definition">Definition at line <a class="el" href="synchronization_8h_source.html#l00687">687</a> of file <a class="el" href="synchronization_8h_source.html">synchronization.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="adebe4ba0a3e1963a1d284180ad8521ac" name="adebe4ba0a3e1963a1d284180ad8521ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adebe4ba0a3e1963a1d284180ad8521ac">&#9670;&#160;</a></span>SharedClausesManager()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">operations_research::sat::SharedClausesManager::SharedClausesManager </td>
          <td>(</td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>always_synchronize</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">absl::Duration</td>          <td class="paramname"><span class="paramname"><em>share_frequency</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="synchronization_8cc_source.html#l01179">1179</a> of file <a class="el" href="synchronization_8cc_source.html">synchronization.cc</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a390489b2496af213519d6fe6445bbeb3" name="a390489b2496af213519d6fe6445bbeb3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a390489b2496af213519d6fe6445bbeb3">&#9670;&#160;</a></span>AddBinaryClause()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void operations_research::sat::SharedClausesManager::AddBinaryClause </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>lit1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>lit2</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Small optim. If the worker is already up to date with clauses to import, we can mark this new clause as already seen.</p>

<p class="definition">Definition at line <a class="el" href="synchronization_8cc_source.html#l01201">1201</a> of file <a class="el" href="synchronization_8cc_source.html">synchronization.cc</a>.</p>

</div>
</div>
<a id="a6732839f19e65abca96f400331b89bee" name="a6732839f19e65abca96f400331b89bee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6732839f19e65abca96f400331b89bee">&#9670;&#160;</a></span>GetClauseStream()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classoperations__research_1_1sat_1_1UniqueClauseStream.html">UniqueClauseStream</a> * operations_research::sat::SharedClausesManager::GetClauseStream </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>id</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>A worker can add or remove clauses from its own clause set. Retains ownership of the returned ClauseFilter. </p>

<p class="definition">Definition at line <a class="el" href="synchronization_8h_source.html#l00711">711</a> of file <a class="el" href="synchronization_8h_source.html">synchronization.h</a>.</p>

</div>
</div>
<a id="a75aa139a83b7c7db55dc8151d31b09f1" name="a75aa139a83b7c7db55dc8151d31b09f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75aa139a83b7c7db55dc8151d31b09f1">&#9670;&#160;</a></span>GetUnseenBinaryClauses()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void operations_research::sat::SharedClausesManager::GetUnseenBinaryClauses </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::pair&lt; int, int &gt; &gt; *</td>          <td class="paramname"><span class="paramname"><em>new_clauses</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fills new_clauses with {{lit1 of clause1, lit2 of clause1}, {lit1 of clause2, lit2 of clause2}, ...} </p>

<p class="definition">Definition at line <a class="el" href="synchronization_8cc_source.html#l01235">1235</a> of file <a class="el" href="synchronization_8cc_source.html">synchronization.cc</a>.</p>

</div>
</div>
<a id="a7b79336ed6c8b47cb8f4cfea2c985c5d" name="a7b79336ed6c8b47cb8f4cfea2c985c5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b79336ed6c8b47cb8f4cfea2c985c5d">&#9670;&#160;</a></span>GetUnseenClauses()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; absl::Span&lt; const int &gt; &gt; operations_research::sat::SharedClausesManager::GetUnseenClauses </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>id</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns new glue clauses. The spans are guaranteed to remain valid until the next call to SyncClauses(). </p>

<p class="definition">Definition at line <a class="el" href="synchronization_8cc_source.html#l01221">1221</a> of file <a class="el" href="synchronization_8cc_source.html">synchronization.cc</a>.</p>

</div>
</div>
<a id="a4046c7b70d9cb4de9e59f29ab24fbf1d" name="a4046c7b70d9cb4de9e59f29ab24fbf1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4046c7b70d9cb4de9e59f29ab24fbf1d">&#9670;&#160;</a></span>LogStatistics()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void operations_research::sat::SharedClausesManager::LogStatistics </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classoperations__research_1_1SolverLogger.html">SolverLogger</a> *</td>          <td class="paramname"><span class="paramname"><em>logger</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="classoperations__research_1_1Search.html" title="---------------— Search class --------------—">Search</a> statistics. </p>

<p class="definition">Definition at line <a class="el" href="synchronization_8cc_source.html#l01248">1248</a> of file <a class="el" href="synchronization_8cc_source.html">synchronization.cc</a>.</p>

</div>
</div>
<a id="a089a13e3aa37086807dde0429507020c" name="a089a13e3aa37086807dde0429507020c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a089a13e3aa37086807dde0429507020c">&#9670;&#160;</a></span>RegisterNewId()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int operations_research::sat::SharedClausesManager::RegisterNewId </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Ids are used to identify which worker is exporting/importing clauses. </p>

<p class="definition">Definition at line <a class="el" href="synchronization_8cc_source.html#l01184">1184</a> of file <a class="el" href="synchronization_8cc_source.html">synchronization.cc</a>.</p>

</div>
</div>
<a id="a56bea8ae926c5bebbd51b97185d4178f" name="a56bea8ae926c5bebbd51b97185d4178f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56bea8ae926c5bebbd51b97185d4178f">&#9670;&#160;</a></span>SetWorkerNameForId()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void operations_research::sat::SharedClausesManager::SetWorkerNameForId </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;</td>          <td class="paramname"><span class="paramname"><em>worker_name</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="synchronization_8cc_source.html#l01195">1195</a> of file <a class="el" href="synchronization_8cc_source.html">synchronization.cc</a>.</p>

</div>
</div>
<a id="a3ebbcf2be803ef7f2cbad87a044dc4ec" name="a3ebbcf2be803ef7f2cbad87a044dc4ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ebbcf2be803ef7f2cbad87a044dc4ec">&#9670;&#160;</a></span>Synchronize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void operations_research::sat::SharedClausesManager::Synchronize </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Unlocks waiting binary clauses for workers if always_synchronize is false. Periodically starts a new sharing round, making glue clauses visible. </p>
<p>Tune LBD threshold for individual workers based on how the worker's buffer is. We aim to ensure workers can always export their fair share of clauses.</p>
<p>Use progressive filling to attempt to fill the batch with clauses of minimum size, this is max-min fair.</p>
<p>Some workers need to export more clauses to fill the batch due to rounding, but we don't want all workers to round up.</p>
<p>Delete batches that have been consumed by all workers. Keep a few batches around for startup (min finished batch doesn't count workers that haven't registered yet). This also ensures that our fingerprint table always contains the last few batches, so we reduce the chance of an old buffered duplicate clause on a worker being emitted from the global stream multiple times.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo002366">Todo</a></b></dt><dd>(user): We could cleanup binary clauses that have been consumed. </dd></dl>

<p class="definition">Definition at line <a class="el" href="synchronization_8cc_source.html#l01265">1265</a> of file <a class="el" href="synchronization_8cc_source.html">synchronization.cc</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>ortools/sat/<a class="el" href="synchronization_8h_source.html">synchronization.h</a></li>
<li>ortools/sat/<a class="el" href="synchronization_8cc_source.html">synchronization.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceoperations__research.html">operations_research</a></li><li class="navelem"><a class="el" href="namespaceoperations__research_1_1sat.html">sat</a></li><li class="navelem"><a class="el" href="classoperations__research_1_1sat_1_1SharedClausesManager.html">SharedClausesManager</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
