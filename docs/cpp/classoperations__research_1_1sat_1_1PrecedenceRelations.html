<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Google OR-Tools: operations_research::sat::PrecedenceRelations Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="orLogo.png"/></td>
  <td id="projectalign">
   <div id="projectname">Google OR-Tools<span id="projectnumber">&#160;v9.11</span>
   </div>
   <div id="projectbrief">a fast and portable software suite for combinatorial optimization</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('classoperations__research_1_1sat_1_1PrecedenceRelations.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classoperations__research_1_1sat_1_1PrecedenceRelations-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">operations_research::sat::PrecedenceRelations Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="precedences_8h_source.html">precedences.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for operations_research::sat::PrecedenceRelations:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classoperations__research_1_1sat_1_1PrecedenceRelations.png" usemap="#operations_5Fresearch::sat::PrecedenceRelations_map" alt=""/>
  <map id="operations_5Fresearch::sat::PrecedenceRelations_map" name="operations_5Fresearch::sat::PrecedenceRelations_map">
<area href="classoperations__research_1_1ReversibleInterface.html" alt="operations_research::ReversibleInterface" shape="rect" coords="0,0,277,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structoperations__research_1_1sat_1_1PrecedenceRelations_1_1PrecedenceData.html">PrecedenceData</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a067a65bdc3d5d7a3454c2f875ff12391" id="r_a067a65bdc3d5d7a3454c2f875ff12391"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a067a65bdc3d5d7a3454c2f875ff12391">PrecedenceRelations</a> (<a class="el" href="classoperations__research_1_1sat_1_1Model.html">Model</a> *<a class="el" href="gurobi__interface_8cc.html#a0728f23c9a47655d38e0bf1a2f200bcf">model</a>)</td></tr>
<tr class="separator:a067a65bdc3d5d7a3454c2f875ff12391"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8f364e6ef490fd3a1a70f5a9e447a50" id="r_ae8f364e6ef490fd3a1a70f5a9e447a50"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae8f364e6ef490fd3a1a70f5a9e447a50">Resize</a> (int num_variables)</td></tr>
<tr class="separator:ae8f364e6ef490fd3a1a70f5a9e447a50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ca1b54209b1598460d8ef4eee99221b" id="r_a4ca1b54209b1598460d8ef4eee99221b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4ca1b54209b1598460d8ef4eee99221b">Add</a> (IntegerVariable <a class="el" href="routing__sat_8cc.html#aff39d864a6594bc5f4a5e365282e00fe">tail</a>, IntegerVariable <a class="el" href="routing__sat_8cc.html#a20358970b1abaf992eb85e071e454653">head</a>, IntegerValue offset)</td></tr>
<tr class="separator:a4ca1b54209b1598460d8ef4eee99221b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b0e71f08a217a8ebd3063c124883f4d" id="r_a1b0e71f08a217a8ebd3063c124883f4d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1b0e71f08a217a8ebd3063c124883f4d">PushConditionalRelation</a> (absl::Span&lt; const <a class="el" href="classoperations__research_1_1sat_1_1Literal.html">Literal</a> &gt; enforcements, IntegerVariable <a class="el" href="constraint__solver_2table_8cc.html#acb18315d548212835cd8ed4287e6c0b6">a</a>, IntegerVariable <a class="el" href="namespaceoperations__research_1_1sat.html#aea68c208c5e7f0abb9afc90d9188d3d4">b</a>, IntegerValue rhs)</td></tr>
<tr class="separator:a1b0e71f08a217a8ebd3063c124883f4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad544b389a3046e12e340ffe9ab615669" id="r_ad544b389a3046e12e340ffe9ab615669"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad544b389a3046e12e340ffe9ab615669">SetLevel</a> (int level) final</td></tr>
<tr class="memdesc:ad544b389a3046e12e340ffe9ab615669"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called each time we change decision level.  <br /></td></tr>
<tr class="separator:ad544b389a3046e12e340ffe9ab615669"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc266b82a08891d9278284b41a66a9ce" id="r_acc266b82a08891d9278284b41a66a9ce"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acc266b82a08891d9278284b41a66a9ce">ComputeFullPrecedences</a> (absl::Span&lt; const IntegerVariable &gt; vars, std::vector&lt; <a class="el" href="structoperations__research_1_1sat_1_1FullIntegerPrecedence.html">FullIntegerPrecedence</a> &gt; *output)</td></tr>
<tr class="separator:acc266b82a08891d9278284b41a66a9ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c7f15ab05754fc8752486cec193ef1e" id="r_a3c7f15ab05754fc8752486cec193ef1e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3c7f15ab05754fc8752486cec193ef1e">CollectPrecedences</a> (absl::Span&lt; const IntegerVariable &gt; vars, std::vector&lt; <a class="el" href="structoperations__research_1_1sat_1_1PrecedenceRelations_1_1PrecedenceData.html">PrecedenceData</a> &gt; *output)</td></tr>
<tr class="separator:a3c7f15ab05754fc8752486cec193ef1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0957ab3a7bfffcc707e302615001e0e" id="r_af0957ab3a7bfffcc707e302615001e0e"><td class="memItemLeft" align="right" valign="top">IntegerValue&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af0957ab3a7bfffcc707e302615001e0e">GetOffset</a> (IntegerVariable <a class="el" href="constraint__solver_2table_8cc.html#acb18315d548212835cd8ed4287e6c0b6">a</a>, IntegerVariable <a class="el" href="namespaceoperations__research_1_1sat.html#aea68c208c5e7f0abb9afc90d9188d3d4">b</a>) const</td></tr>
<tr class="separator:af0957ab3a7bfffcc707e302615001e0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab196764d3d6fc8d0027ab4944ba955b2" id="r_ab196764d3d6fc8d0027ab4944ba955b2"><td class="memItemLeft" align="right" valign="top">IntegerValue&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab196764d3d6fc8d0027ab4944ba955b2">GetConditionalOffset</a> (IntegerVariable <a class="el" href="constraint__solver_2table_8cc.html#acb18315d548212835cd8ed4287e6c0b6">a</a>, IntegerVariable <a class="el" href="namespaceoperations__research_1_1sat.html#aea68c208c5e7f0abb9afc90d9188d3d4">b</a>) const</td></tr>
<tr class="separator:ab196764d3d6fc8d0027ab4944ba955b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af10560fe3a464eb4b15cbed4628d494b" id="r_af10560fe3a464eb4b15cbed4628d494b"><td class="memItemLeft" align="right" valign="top">absl::Span&lt; const <a class="el" href="classoperations__research_1_1sat_1_1Literal.html">Literal</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af10560fe3a464eb4b15cbed4628d494b">GetConditionalEnforcements</a> (IntegerVariable <a class="el" href="constraint__solver_2table_8cc.html#acb18315d548212835cd8ed4287e6c0b6">a</a>, IntegerVariable <a class="el" href="namespaceoperations__research_1_1sat.html#aea68c208c5e7f0abb9afc90d9188d3d4">b</a>) const</td></tr>
<tr class="separator:af10560fe3a464eb4b15cbed4628d494b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95dab1b3432098f1e966ec42fb3a26f3" id="r_a95dab1b3432098f1e966ec42fb3a26f3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a95dab1b3432098f1e966ec42fb3a26f3">Build</a> ()</td></tr>
<tr class="separator:a95dab1b3432098f1e966ec42fb3a26f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classoperations__research_1_1ReversibleInterface"><td colspan="2" onclick="javascript:dynsection.toggleInherit('pub_methods_classoperations__research_1_1ReversibleInterface')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classoperations__research_1_1ReversibleInterface.html">operations_research::ReversibleInterface</a></td></tr>
<tr class="memitem:adb9aa4096803957a1de5b1ae6145b8dd inherit pub_methods_classoperations__research_1_1ReversibleInterface" id="r_adb9aa4096803957a1de5b1ae6145b8dd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoperations__research_1_1ReversibleInterface.html#adb9aa4096803957a1de5b1ae6145b8dd">ReversibleInterface</a> ()</td></tr>
<tr class="separator:adb9aa4096803957a1de5b1ae6145b8dd inherit pub_methods_classoperations__research_1_1ReversibleInterface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2efac358c1c295fa65026c8d21f6ab9a inherit pub_methods_classoperations__research_1_1ReversibleInterface" id="r_a2efac358c1c295fa65026c8d21f6ab9a"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoperations__research_1_1ReversibleInterface.html#a2efac358c1c295fa65026c8d21f6ab9a">~ReversibleInterface</a> ()</td></tr>
<tr class="separator:a2efac358c1c295fa65026c8d21f6ab9a inherit pub_methods_classoperations__research_1_1ReversibleInterface"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Stores all the precedences relation of the form "tail_X + offset &lt;= head_X" that we could extract from the linear constraint of the model. These are stored in a directed graph.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo002106">Todo</a></b></dt><dd><p class="startdd">(user): Support conditional relation. </p>
<p class="interdd">(user): Support non-DAG like graph. </p>
<p class="enddd">(user): Support variable offset that can be updated as search progress. </p>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="precedences_8h_source.html#l00055">55</a> of file <a class="el" href="precedences_8h_source.html">precedences.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a067a65bdc3d5d7a3454c2f875ff12391" name="a067a65bdc3d5d7a3454c2f875ff12391"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a067a65bdc3d5d7a3454c2f875ff12391">&#9670;&#160;</a></span>PrecedenceRelations()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">operations_research::sat::PrecedenceRelations::PrecedenceRelations </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classoperations__research_1_1sat_1_1Model.html">Model</a> *</td>          <td class="paramname"><span class="paramname"><em>model</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="precedences_8h_source.html#l00057">57</a> of file <a class="el" href="precedences_8h_source.html">precedences.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a4ca1b54209b1598460d8ef4eee99221b" name="a4ca1b54209b1598460d8ef4eee99221b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ca1b54209b1598460d8ef4eee99221b">&#9670;&#160;</a></span>Add()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool operations_research::sat::PrecedenceRelations::Add </td>
          <td>(</td>
          <td class="paramtype">IntegerVariable</td>          <td class="paramname"><span class="paramname"><em>tail</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IntegerVariable</td>          <td class="paramname"><span class="paramname"><em>head</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IntegerValue</td>          <td class="paramname"><span class="paramname"><em>offset</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add a relation tail + offset &lt;= head. Returns true if it was added and is considered "new". </p>
<p>Ignore trivial relation: tail + offset &lt;= head.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo002073">Todo</a></b></dt><dd>(user): Return infeasible if tail == head and offset &gt; 0. </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo002074">Todo</a></b></dt><dd></dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo002075">Todo</a></b></dt><dd>(user): if tail = Negation(head) also update <a class="el" href="classoperations__research_1_1Domain.html">Domain</a>. </dd></dl>
<p>Add to root_relations_.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo002076">Todo</a></b></dt><dd>(user): AddInternal() only returns true if this is the first relation between head and tail. But we can still avoid an extra lookup. </dd></dl>
<p>If we are not built, make sure there is enough room in the graph. </p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo002077">Todo</a></b></dt><dd>(user): Alternatively, force caller to do a <a class="el" href="#ae8f364e6ef490fd3a1a70f5a9e447a50">Resize()</a>. </dd></dl>

<p class="definition">Definition at line <a class="el" href="precedences_8cc_source.html#l00054">54</a> of file <a class="el" href="precedences_8cc_source.html">precedences.cc</a>.</p>

</div>
</div>
<a id="a95dab1b3432098f1e966ec42fb3a26f3" name="a95dab1b3432098f1e966ec42fb3a26f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95dab1b3432098f1e966ec42fb3a26f3">&#9670;&#160;</a></span>Build()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void operations_research::sat::PrecedenceRelations::Build </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The current code requires the internal data to be processed once all relations are loaded.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo002115">Todo</a></b></dt><dd>(user): Be more dynamic as we start to add relations during search. </dd></dl>
<p>We will construct a graph with the current relation from all_relations_. And use this to compute the "closure". </p><dl class="section note"><dt>Note</dt><dd>the non-determinism of the arcs order shouldn't matter.</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo002078">Todo</a></b></dt><dd>(user): Support negative offset?</dd></dl>
<dl class="section note"><dt>Note</dt><dd>if we only have &gt;= 0 ones, if we do have a cycle, we could make sure all variales are the same, and otherwise, we have a DAG or a conflict.</dd></dl>
<p>We have two arcs.</p>
<p>Is it a DAG? Get a topological order of the DAG formed by all the arcs that are present.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo002079">Todo</a></b></dt><dd>(user): This can fail if we don't have a DAG. We could just skip Bad edges instead, and have a sub-DAG as an heuristic. Or analyze the arc weight and make sure cycle are not an issue. We can also start with arcs with strictly positive weight.</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo002080">Todo</a></b></dt><dd>(user): Only explore the sub-graph reachable from "vars". </dd></dl>
<p>Lets build full precedences if we don't have too many of them. </p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo002081">Todo</a></b></dt><dd>(user): Also do that if we don't have a DAG? </dd></dl>

<p class="definition">Definition at line <a class="el" href="precedences_8cc_source.html#l00208">208</a> of file <a class="el" href="precedences_8cc_source.html">precedences.cc</a>.</p>

</div>
</div>
<a id="a3c7f15ab05754fc8752486cec193ef1e" name="a3c7f15ab05754fc8752486cec193ef1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c7f15ab05754fc8752486cec193ef1e">&#9670;&#160;</a></span>CollectPrecedences()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void operations_research::sat::PrecedenceRelations::CollectPrecedences </td>
          <td>(</td>
          <td class="paramtype">absl::Span&lt; const IntegerVariable &gt;</td>          <td class="paramname"><span class="paramname"><em>vars</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="structoperations__research_1_1sat_1_1PrecedenceRelations_1_1PrecedenceData.html">PrecedenceData</a> &gt; *</td>          <td class="paramname"><span class="paramname"><em>output</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>+1 for the negation.</p>
<p>We first compute the degree/size in order to perform the transposition. </p><dl class="section note"><dt>Note</dt><dd>we also remove duplicates.</dd></dl>
<p>We do not want duplicates.</p>
<p>Permute tmp_precedences_ into the output to put it in the correct order. For that we transform var_to_degree to point to the first position of each lbvar in the output vector.</p>
<p>Optimization: we remove degree one relations.</p>
<dl class="section note"><dt>Note</dt><dd>it is okay to increase the -1 pos since they appear only once.</dd></dl>
<p>Cleanup var_to_degree, note that we don't need to clean var_to_last_index_.</p>

<p class="definition">Definition at line <a class="el" href="precedences_8cc_source.html#l00406">406</a> of file <a class="el" href="precedences_8cc_source.html">precedences.cc</a>.</p>

</div>
</div>
<a id="acc266b82a08891d9278284b41a66a9ce" name="acc266b82a08891d9278284b41a66a9ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc266b82a08891d9278284b41a66a9ce">&#9670;&#160;</a></span>ComputeFullPrecedences()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void operations_research::sat::PrecedenceRelations::ComputeFullPrecedences </td>
          <td>(</td>
          <td class="paramtype">absl::Span&lt; const IntegerVariable &gt;</td>          <td class="paramname"><span class="paramname"><em>vars</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="structoperations__research_1_1sat_1_1FullIntegerPrecedence.html">FullIntegerPrecedence</a> &gt; *</td>          <td class="paramname"><span class="paramname"><em>output</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns a set of relations var &gt;= max_i(vars[index[i]] + offsets[i]).</p>
<p>This currently only works if the precedence relation form a DAG. If not we will just abort. </p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo002111">Todo</a></b></dt><dd>(user): generalize.</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo002112">Todo</a></b></dt><dd>(user): Put some work limit in place, as this can be slow. Complexity is in O(vars.size()) * num_arcs.</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo002113">Todo</a></b></dt><dd>(user): Since we don't need ALL precedences, we could just work on a sub-DAG of the full precedence graph instead of aborting. Or we can just support the general non-DAG cases.</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo002114">Todo</a></b></dt><dd>(user): Many relations can be redundant. Filter them. </dd></dl>
<p>Compute all precedences. We loop over the node in topological order, and we maintain for all variable we encounter, the list of "to_consider" variables that are before.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo002082">Todo</a></b></dt><dd>(user): use vector of fixed size. </dd></dl>
<p>We copy the data for tail_var here, because the pointer is not stable. </p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo002083">Todo</a></b></dt><dd>(user): optimize when needed. </dd></dl>
<p>No need to create an empty entry in this case.</p>
<p>Small filtering heuristic: if we have (before) &lt; tail, and tail &lt; head, we really do not need to list (before, tail) &lt; head. We only need that if the list of variable before head contains some variable that are not already before tail.</p>
<p>Extract the output for tail_var. Because of the topological ordering, the data for tail_var is already final now.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo002084">Todo</a></b></dt><dd>(user): Release the memory right away. </dd></dl>

<p class="definition">Definition at line <a class="el" href="precedences_8cc_source.html#l00312">312</a> of file <a class="el" href="precedences_8cc_source.html">precedences.cc</a>.</p>

</div>
</div>
<a id="af10560fe3a464eb4b15cbed4628d494b" name="af10560fe3a464eb4b15cbed4628d494b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af10560fe3a464eb4b15cbed4628d494b">&#9670;&#160;</a></span>GetConditionalEnforcements()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">absl::Span&lt; const <a class="el" href="classoperations__research_1_1sat_1_1Literal.html">Literal</a> &gt; operations_research::sat::PrecedenceRelations::GetConditionalEnforcements </td>
          <td>(</td>
          <td class="paramtype">IntegerVariable</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IntegerVariable</td>          <td class="paramname"><span class="paramname"><em>b</em></span>&#160;) const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="precedences_8cc_source.html#l00178">178</a> of file <a class="el" href="precedences_8cc_source.html">precedences.cc</a>.</p>

</div>
</div>
<a id="ab196764d3d6fc8d0027ab4944ba955b2" name="ab196764d3d6fc8d0027ab4944ba955b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab196764d3d6fc8d0027ab4944ba955b2">&#9670;&#160;</a></span>GetConditionalOffset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">IntegerValue operations_research::sat::PrecedenceRelations::GetConditionalOffset </td>
          <td>(</td>
          <td class="paramtype">IntegerVariable</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IntegerVariable</td>          <td class="paramname"><span class="paramname"><em>b</em></span>&#160;) const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns the minimum distance between a and b, and the reason for it (all true). Note that we always check <a class="el" href="#af0957ab3a7bfffcc707e302615001e0e">GetOffset()</a> so if it is better, the returned literal reason will be empty.</p>
<p>We separate the two because usually the reason is only needed when we push, which happen less often, so we don't mind doing two hash lookups, and we really want to optimize the <a class="el" href="#ab196764d3d6fc8d0027ab4944ba955b2">GetConditionalOffset()</a> instead.</p>
<p>Important: This doesn't contains the transitive closure. Important: The span is only valid in a narrow scope. </p>

<p class="definition">Definition at line <a class="el" href="precedences_8cc_source.html#l00197">197</a> of file <a class="el" href="precedences_8cc_source.html">precedences.cc</a>.</p>

</div>
</div>
<a id="af0957ab3a7bfffcc707e302615001e0e" name="af0957ab3a7bfffcc707e302615001e0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0957ab3a7bfffcc707e302615001e0e">&#9670;&#160;</a></span>GetOffset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">IntegerValue operations_research::sat::PrecedenceRelations::GetOffset </td>
          <td>(</td>
          <td class="paramtype">IntegerVariable</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IntegerVariable</td>          <td class="paramname"><span class="paramname"><em>b</em></span>&#160;) const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>If we don't have too many variable, we compute the full transitive closure and can query in O(1) if there is a relation between two variables. This can be used to optimize some scheduling propagation and reasons.</p>
<dl class="section warning"><dt>Warning</dt><dd>If there are too many, this will NOT contain all relations.</dd></dl>
<p>Returns kMinIntegerValue if there are none. Otherwise a + offset &lt;= b. </p>

<p class="definition">Definition at line <a class="el" href="precedences_8cc_source.html#l00169">169</a> of file <a class="el" href="precedences_8cc_source.html">precedences.cc</a>.</p>

</div>
</div>
<a id="a1b0e71f08a217a8ebd3063c124883f4d" name="a1b0e71f08a217a8ebd3063c124883f4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b0e71f08a217a8ebd3063c124883f4d">&#9670;&#160;</a></span>PushConditionalRelation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void operations_research::sat::PrecedenceRelations::PushConditionalRelation </td>
          <td>(</td>
          <td class="paramtype">absl::Span&lt; const <a class="el" href="classoperations__research_1_1sat_1_1Literal.html">Literal</a> &gt;</td>          <td class="paramname"><span class="paramname"><em>enforcements</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IntegerVariable</td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IntegerVariable</td>          <td class="paramname"><span class="paramname"><em>b</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IntegerValue</td>          <td class="paramname"><span class="paramname"><em>rhs</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Adds add relation (enf =&gt; a + b &lt;= rhs) that is assumed to be true at the current level.</p>
<p>It will be automatically reverted via the <a class="el" href="#ad544b389a3046e12e340ffe9ab615669" title="Called each time we change decision level.">SetLevel()</a> functions that is called before any integer propagations trigger.</p>
<p>This is assumed to be called when a relation becomes true (enforcement are assigned) and when it becomes false in reverse order (CHECKed). </p>
<p>This must be currently true.</p>
<p>Ignore if no better than best_relations, otherwise increase it.</p>
<p>We should only decrease because we ignored entry worse than the one in best_relations_.</p>
<p>Update.</p>

<p class="definition">Definition at line <a class="el" href="precedences_8cc_source.html#l00083">83</a> of file <a class="el" href="precedences_8cc_source.html">precedences.cc</a>.</p>

</div>
</div>
<a id="ae8f364e6ef490fd3a1a70f5a9e447a50" name="ae8f364e6ef490fd3a1a70f5a9e447a50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8f364e6ef490fd3a1a70f5a9e447a50">&#9670;&#160;</a></span>Resize()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void operations_research::sat::PrecedenceRelations::Resize </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>num_variables</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="precedences_8h_source.html#l00064">64</a> of file <a class="el" href="precedences_8h_source.html">precedences.h</a>.</p>

</div>
</div>
<a id="ad544b389a3046e12e340ffe9ab615669" name="ad544b389a3046e12e340ffe9ab615669"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad544b389a3046e12e340ffe9ab615669">&#9670;&#160;</a></span>SetLevel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void operations_research::sat::PrecedenceRelations::SetLevel </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>level</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">final</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Called each time we change decision level. </p>
<p>We only pop what is needed. </p>

<p>Implements <a class="el" href="classoperations__research_1_1ReversibleInterface.html#ae25ce6ee33b736226102678c3a14b1dd">operations_research::ReversibleInterface</a>.</p>

<p class="definition">Definition at line <a class="el" href="precedences_8cc_source.html#l00142">142</a> of file <a class="el" href="precedences_8cc_source.html">precedences.cc</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>ortools/sat/<a class="el" href="precedences_8h_source.html">precedences.h</a></li>
<li>ortools/sat/<a class="el" href="precedences_8cc_source.html">precedences.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceoperations__research.html">operations_research</a></li><li class="navelem"><a class="el" href="namespaceoperations__research_1_1sat.html">sat</a></li><li class="navelem"><a class="el" href="classoperations__research_1_1sat_1_1PrecedenceRelations.html">PrecedenceRelations</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
